<launch>
    <!--========= LAUNCH FILE ARGUMENTS ======================================================-->
    <!-- defines the xterm parameters for the clients, set to empty to skip using xterm window-->
    <arg name="server_nodes_xterms" default="xterm -hold -e" />

    <!-- defines the xterm parameters for the state machine, set to empty to skip using xterm window-->
    <arg name="sm_xterm" default="xterm -hold -geometry 1000x600 -sl 10000 -e" />

    <!-- if true, gazebo client is shown -->
    <arg name="show_gz_client" default="true" />

    <!-- if true, smacc_viewer is shown -->
    <arg name="show_smacc_viewer" default="true" />

    <!-- if true, rviz is shown -->
    <arg name="show_rviz" default="true" />

    <!-- It does not start the sm node in order to start it from your standalone process with debugger-->
    <arg name="debug" default="false" />

    <env name="ROSCONSOLE_CONFIG_FILE" value="$(find sm_opencv)/config/rosconsole.config" />

    <!--================================================================================-->
    <!-- load the navigation environment simulated in gazebo-->
    <include file="$(find sm_opencv)/launch/ridgeback_simulation.launch">
    
    </include>


    <node pkg="move_base" type="move_base" respawn="true" name="move_base" launch-prefix="xterm -hold -e ">
        <rosparam file="$(find sm_dance_bot_strikes_back)/config/move_base_client/costmap_common_params.yaml" command="load" ns="global_costmap" />
        <rosparam file="$(find sm_dance_bot_strikes_back)/config/move_base_client/costmap_common_params.yaml" command="load" ns="local_costmap" />

        <!-- <rosparam file="$(find ridgeback_navigation)/params/odom_nav_params/global_costmap_params.yaml" command="load" />
        <rosparam file="$(find ridgeback_navigation)/params/odom_nav_params/local_costmap_params.yaml" command="load" /> -->
        <rosparam file="$(find sm_dance_bot_strikes_back)/config/move_base_client/global_costmap_params.yaml" command="load" />
        <rosparam file="$(find sm_dance_bot_strikes_back)/config/move_base_client/local_costmap_params.yaml" command="load" />
        

         <!-- <rosparam file="$(find ridgeback_navigation)/params/base_local_planner_params.yaml" command="load" /> -->
         <rosparam file="$(find sm_dance_bot_strikes_back)/config/move_base_client/base_local_planner_params.yaml" command="load" /> 
        

        <rosparam file="$(find ridgeback_navigation)/params/move_base_params.yaml" command="load" />

        <param name="base_global_planner" type="string" value="navfn/NavfnROS" />
        <param name="base_local_planner" value="base_local_planner/TrajectoryPlannerROS"/>

        <remap from="odom" to="odometry/filtered" />
    </node>

    <!-- <include file="$(find ridgeback_navigation)/launch/include/amcl.launch" /> -->

    <!--  setup smacc planners configuration  -->
    <group ns="move_base">
        <!-- backward local planner -->
        <rosparam file="$(find sm_opencv)/config/move_base_client/backward_local_planner.yaml" command="load" />
        <!-- forward local planner -->
        <rosparam file="$(find sm_opencv)/config/move_base_client/forward_local_planner.yaml" command="load" />

        <param name="waypoints_plan" value="$(find sm_opencv)/config/move_base_client/waypoints_plan.yaml" />
    </group>

    <!-- load state machine parameters -->
    <rosparam command="load" file="$(find sm_opencv)/config/radial_motion_sm_config.yaml" />

    <!-- state machine node -->
    <node pkg="sm_opencv" type="sm_opencv_node" name="sm_opencv" launch-prefix="$(arg sm_xterm)" unless="$(arg debug)">
        <remap from="/odom" to="/odometry/filtered" />
        <remap from="/sm_opencv/odom_tracker/odom_tracker_path" to="/odom_tracker_path"/>
        <remap from="/sm_opencv/odom_tracker/odom_tracker_stacked_path" to="/odom_tracker_path_stacked"/>
    </node>

    <node pkg="rviz" type="rviz" name="rviz" args="-d $(find sm_opencv)/config/navigation.rviz" if="$(arg show_rviz)">
        <remap from="/remap_smacc_status" to="/SmDanceBot/smacc/status" />
    </node>
</launch>